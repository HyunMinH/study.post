# 프로시저 추상화와 기능 분해

## 메인 함수로서의 시스템

- 프로시저만으로는 효과적인 정보은닉 체계를 구축하는 데는 한계가 있음.

- 하향식 접근법을 따름.

## 급여 관리 시스템

### 메인 프로시저 (첫 시작)

```
직원의 급여를 계산한다.
```

### 좀 더 세부적인 절차로
```
직원의 급여를 계산한다.
    사용자로부터 소득세율을 입력받는다.
    직원의 급여를 계산한다.
    양식에 맞게 결과를 출력한다.
```

### 구현이 가능할 정도로 충분히 저수준의 문장이 될 때까지 기능 분해
```
직원의 급여를 계산한다.
    사용자로부터 소득세율을 입력받는다.
        "세율을 입력하세요" 라는 문장을 화면에 출력한다.
        키보드를 통해 세율을 입력받는다.
    직원의 급여를 계산한다.
        전역 변수에 저장된 직원의 기본급 정보를 얻는다.
        급여를 계산한다.
    양식에 맞게 결과를 출력한다.
        "이름 : {직원명}, 급여 : {계산된 금액}" 형식에 따라 출력 문자열을 생성한다.
```

- 이 방식에서는 기능을 중심으로 필요한 데이터를 결정한다.

## 하향식 기능 분해의 문제점

- 겉으로 보기에는 문제 없어보이나 아래의 문제점들이 도사리고 있음. (모두 변경에 취약)

### 시스템은 하나의 메인 함수로 구성돼 있지 않다.

- 어느 시점에 이르면 유일한 메인 함수라는 개념은 의미가 없어지고, 시스템은 여러 개의 동등한 수준의 함수 집합으로 성장하게 될 것이다.

    - 이 때 모든 기능을 자식 노드로 가지는 하나의 메인 기능을 선택하기라는 어렵다.

- 대부분의 시스템에서는 하나의 메인 기능이란 개념은 존재 하지 않는다.

### 기능 추가나 요구사항 변경으로 인해 메인 함수를 빈번하게 수정해야 한다.

- 하나의 메인 함수를 유일한 정상으로 간주하는 하향식 기능 분해는 새로운 기능 추가 때마다 매번 메인 함수를 수정해야 한다.

### 비즈니스 로직이 사용자 인터페이스와 강하게 결합된다.

- 하향식 접근법은 비즈니스 로직을 설계하는 초기 단계부터 입력 방법과 출력 양식을 함께 고민하도록 강요한다.

- 사용자 인터페이스를 콘솔에서 GUI 기반으로 변경한다 했을 때 쉽지 않다.

### 하향식 분해는 너무 이른 시기에 함수들의 실행 순서를 고정시키기 때문에 유연성과 재사용성이 저하된다.

- 설계를 시작하는 시점부터 시스템이 무엇을 해야 하는지가 아니라 어떻게 동작해야 하는지에 집중하도록 만든다.

### + 위의 모든 문제의 원인은 함수는 상위 함수가 강요하는 문맥에 강하게 결합되어 있기 때문이다.

### 데이터 형식이 변경될 경우 파급효과를 예측할 수없다.

- 어떤 데이터를 어떤 함수가 사용하고 있는지를 추적하기 어려워 데이터 변경으로 어떤 함수가 영향을 받을지 예상하기 어렵다.

## 언제 하향식 분해가 유용한가

- 설계가 어느 정도 안정화된 후에 설계의 다양한 측면을 논리적으로 설명하고 문서화하기에는 좋다.

- 하지만 실제로 동작하는 커다란 소프트웨어를 설계하는 데 적합한 방법은 아니다.